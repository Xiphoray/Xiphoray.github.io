<style>html,body{margin:0;padding:0;width:100%;height:100%;background:#000}.app{position:relative;width:100vw;height:100vh;overflow:hidden;z-index:199999}.canvas-wrap{position:absolute;inset:0;z-index:199999}#bgCanvas,#mainCanvas{position:absolute;left:0;top:0;width:100%;height:100%;display:block}#bgCanvas{z-index:0}#mainCanvas{z-index:1}.hud{position:absolute;left:12px;top:12px;max-width:70vw;max-height:50vw;overflow:auto;padding:8px 10px;box-sizing:border-box;color:#00FF00;font-family:"Courier New",Courier,monospace;font-size:14px;line-height:1.5em;background:rgba(128,128,128,0.3);border-radius:6px;z-index:1999999;user-select:none;pointer-events:auto;white-space:pre}.hud::-webkit-scrollbar{width:8px}.hud::-webkit-scrollbar-track{background:rgba(128,128,128,0.3);border-radius:4px}.hud::-webkit-scrollbar-thumb{background:rgba(128,128,128,0.6);border-radius:4px}.hud::-webkit-scrollbar-thumb:hover{background:rgba(128,128,128,0.8)}.hud{scrollbar-width:thin;scrollbar-color:rgba(128,128,128,0.6)rgba(128,128,128,0.3)}.reset-btn{position:absolute;right:12px;bottom:12px;z-index:1999999;padding:6px 10px;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,Helvetica,sans-serif;font-size:12px;color:#111;background:#FFBF00;border:none;border-radius:4px;box-shadow:0 1px 3px rgba(0,0,0,0.4);cursor:pointer;opacity:0.9}.reset-btn:hover{opacity:1}@media(max-width:480px){.hud{font-size:12px}}</style><div id="app"class="app"><div class="canvas-wrap"><canvas id="bgCanvas"></canvas><canvas id="mainCanvas"></canvas></div><div id="hud"class="hud"aria-live="polite"aria-atomic="false"></div><button id="resetViewBtn"class="reset-btn"type="button"title="重置视野"aria-label="重置视野">RESET</button></div><!--Inline seedrandom library--><script src="https://cdn.jsdelivr.net/npm/seedrandom@3.0.5/seedrandom.min.js"></script><!--Inline application code--><script>(function(){'use strict';function getTodaySeed(){const now=new Date();const y=now.getFullYear();const m=String(now.getMonth()+1).padStart(2,'0');const d=String(now.getDate()).padStart(2,'0');return`${y}${m}${d}`}function hashStringTo32Bits(str){let h=0x811c9dc5>>>0;for(let i=0;i<str.length;i++){h^=str.charCodeAt(i);h=Math.imul(h,0x01000193)}return h>>>0}function lcg(seedStr){let state=(hashStringTo32Bits(seedStr)||1)>>>0;const m=0x100000000;const a=1664525;const c=1013904223;return function next(){state=(Math.imul(a,state)+c)>>>0;return(state>>>0)/m}}function createRNG(seedStr){const sr=(typeof window!=='undefined'&&(window.seedrandom||window.Math?.seedrandom))?(window.seedrandom||window.Math.seedrandom):null;if(sr){try{const rng=sr(seedStr);if(typeof rng==='function')return rng;if(typeof rng==='object'&&typeof rng.double==='function')return()=>rng.double()}catch(e){console.warn('seedrandom init failed, falling back to LCG:',e)}}else{console.warn('seedrandom.js not found, using fallback LCG.')}return lcg(seedStr)}function randFloat(rng,min=0,max=1){return min+(max-min)*rng()}function randInt(rng,min,maxInclusive){const x=rng();return Math.floor(min+(maxInclusive-min+1)*x)}function choice(rng,arr){return arr[Math.floor(rng()*arr.length)]}const G=6.674e-11;const KM=1000;const TAU=Math.PI*2;function clamp(x,lo,hi){return Math.max(lo,Math.min(hi,x))}const STAR_NAME_PREFIX=['Alpha','Beta','Gamma','Delta','Epsilon','Zeta'];const STAR_NAME_SUFFIX=['Centauri','Eridani','Draconis','Phoenicis'];const PLANET_NAMES_BASE=['Mercury','Venus','Terra','Mars','Jupiter','Saturn','Uranus','Neptune','Ceres','Pluto','Eris','Titan','Europa','Callisto','Ganymede','Io','Enceladus','Triton','Charon','Makemake','Zeus','Hera','Poseidon','Athena','Apollo','Artemis','Ares','Hephaestus','Hermes','Dionysus','Hades','Demeter','Hestia','Aphrodite','Persephone','Prometheus','Atlas','Helios'];const GEO_TYPES=['Rocky','Iron-Core','Silicate','Frozen','Metallic','Carbon-Based','Sulfide','Basaltic','Granitic','Sedimentary','Volcanic','Crystalline','Oceanic','Desert','Tectonic','Metamorphic','Calcareous','Ferrous','Regolithic','Chondritic'];const ATMOS=['None','Thin','Nitrogen-Oxygen','Carbon-Dioxide','Methane','Ammonia','Hydrogen','Helium','Hydrogen-Sulfide','Argon','Neon','Chlorine','Fluorine','Sulfur-Dioxide','Nitrogen','Oxygen-Rich','Toxic','Corrosive','Inert','Reducing'];const FAUNA=['None','Microbial','Arthropod','Reptilian','Mammalian','Sentient','Mechanical','Energy-Based','Avian','Amphibian','Cephalopod','Insectoid','Crystalline','Fungoid','Aquatic','Silicon-Based','Hive-Mind','Parasitic','Symbiotic','Swarm'];const FLORA=['None','Unicellular-Algae','Moss','Fern','Gymnosperm','Angiosperm','Fungal','Crystalline-Life','Lichen','Conifer','Succulent','Carnivorous','Bioluminescent','Symbiotic','Photosynthetic','Chemosynthetic','Spore-Based','Vine','Tree','Aquatic-Plants'];function romanize(num){if(num<=0)return'';const map=[[1000,'M'],[900,'CM'],[500,'D'],[400,'CD'],[100,'C'],[90,'XC'],[50,'L'],[40,'XL'],[10,'X'],[9,'IX'],[5,'V'],[4,'IV'],[1,'I']];let n=Math.floor(num),out='';for(const[v,s]of map){while(n>=v){out+=s;n-=v}}return out}function pickSystemName(rng){return`${choice(rng,STAR_NAME_PREFIX)}${choice(rng,STAR_NAME_SUFFIX)}`}function pickSystemCode(rng){const A=65;const c1=String.fromCharCode(A+randInt(rng,0,25));const c2=String.fromCharCode(A+randInt(rng,0,25));const num=String(randInt(rng,0,9999)).padStart(4,'0');return`${c1}${c2}-${num}`}function pickPlanetName(rng,used){for(let t=0;t<100;t++){const base=choice(rng,PLANET_NAMES_BASE);const withRoman=(rng()<0.25)?`${base}${romanize(randInt(rng,1,12))}`:base;if(!used.has(withRoman)){used.add(withRoman);return withRoman}}let i=1;for(;;){const name=`${choice(rng,PLANET_NAMES_BASE)}-${i++}`;if(!used.has(name)){used.add(name);return name}}}function pickMaybeCombo(rng,arr){if(rng()<0.18){const a=choice(rng,arr);let b=choice(rng,arr);if(b===a)b=choice(rng,arr);return`${a}+${b}`}return choice(rng,arr)}function pickGeo(rng){return pickMaybeCombo(rng,GEO_TYPES)}function pickAtmo(rng){return pickMaybeCombo(rng,ATMOS)}function pickFauna(rng){return pickMaybeCombo(rng,FAUNA)}function pickFlora(rng){return pickMaybeCombo(rng,FLORA)}function orbitalSpeed(massCentralKg,radiusM){return Math.sqrt(G*massCentralKg/radiusM)}function orbitalPeriod(radiusM,speedMps){return(TAU*radiusM)/speedMps}function computeTimeScale(outerPeriodSec,targetMinSec=120,targetMaxSec=300){const target=clamp(targetMinSec+(targetMaxSec-targetMinSec)*0.5,targetMinSec,targetMaxSec);let scale=outerPeriodSec/target;scale=clamp(scale,500,2000);return{timeScale:scale,targetPeriodSec:target}}function classifyStar(massKg){if(massKg<1e29)return'D';if(massKg<2e29)return'C';if(massKg<3e29)return'B';if(massKg<4e29)return'A';return'S'}function pickOrbits(rng,starRadiusM,planetCount){const minR=starRadiusM*3,maxR=starRadiusM*30;const eps=1e-6;const a0=minR*(1+eps);const orbits=new Array(planetCount);orbits[0]=a0;for(let i=1;i<planetCount;i++){const k=randFloat(rng,1.1,2.0);let candidate=orbits[i-1]*k;if(candidate>maxR*0.95){candidate=maxR*0.95}orbits[i]=candidate;if(candidate>=maxR*0.95){return orbits.slice(0,i+1)}}return orbits}function computeHillRadius(aM,mP,mS){return aM*0.01*Math.cbrt(mP/mS)}function pickPlanetPhysicals(rng,starMassKg){const fMin=1e-6,fMax=1e-3;for(let tries=0;tries<50;tries++){const radiusKm=randInt(rng,1000,20000);const rM=radiusKm*KM;const volume=(4/3)*Math.PI*rM*rM*rM;const rhoLow=Math.max(3000,(starMassKg*fMin)/volume);const rhoHigh=Math.min(8000,(starMassKg*fMax)/volume);if(rhoLow<=rhoHigh){const density=randFloat(rng,rhoLow,rhoHigh);const mass=density*volume;return{radiusKm,radiusM:rM,densityKgPerM3:density,massKg:mass}}}const radiusKm=8000;const rM=radiusKm*KM;const volume=(4/3)*Math.PI*rM*rM*rM;const density=clamp((starMassKg*1e-5)/volume,3000,8000);const mass=density*volume;return{radiusKm,radiusM:rM,densityKgPerM3:density,massKg:mass}}function generateSolarSystem(rng){const starRadiusKm=randInt(rng,30000,70000);const starRadiusM=starRadiusKm*KM;const starMassKg=randFloat(rng,1e28,5e29);const starClass=classifyStar(starMassKg);const systemName=pickSystemName(rng);const systemCode=pickSystemCode(rng);const planetCount=randInt(rng,1,10);const orbits=pickOrbits(rng,starRadiusM,planetCount);const usedNames=new Set();const planets=[];for(let i=0;i<orbits.length;i++){const aM=orbits[i];const phys=pickPlanetPhysicals(rng,starMassKg);const v=orbitalSpeed(starMassKg,aM);const T=orbitalPeriod(aM,v);const hillM=computeHillRadius(aM,phys.massKg,starMassKg);const hue=randInt(rng,0,360);const sat=randInt(rng,40,90);const light=randInt(rng,40,70);const color=`hsl(${hue},${sat}%,${light}%)`;planets.push({name:pickPlanetName(rng,usedNames),geo:pickGeo(rng),atmo:pickAtmo(rng),fauna:pickFauna(rng),flora:pickFlora(rng),color:color,massKg:phys.massKg,densityKgPerM3:phys.densityKgPerM3,radiusKm:phys.radiusKm,radiusM:phys.radiusM,orbitRadiusM:aM,orbitRadiusKm:aM/KM,orbitSpeedMps:v,orbitSpeedKmps:v/1000,orbitPeriodSec:T,phaseRad:randFloat(rng,0,Math.PI*2),hillRadiusM:hillM,hillRadiusKm:hillM/KM})}for(let i=1;i<planets.length;i++){const prev=planets[i-1],cur=planets[i];const radialGap=cur.orbitRadiusM-prev.orbitRadiusM;if(radialGap<=prev.hillRadiusM+cur.hillRadiusM){const needed=prev.hillRadiusM+cur.hillRadiusM+1;const newA=prev.orbitRadiusM+needed;cur.orbitRadiusM=newA;cur.orbitRadiusKm=newA/KM;const v=orbitalSpeed(starMassKg,newA);cur.orbitSpeedMps=v;cur.orbitSpeedKmps=v/1000;cur.orbitPeriodSec=orbitalPeriod(newA,v);cur.hillRadiusM=computeHillRadius(newA,cur.massKg,starMassKg);cur.hillRadiusKm=cur.hillRadiusM/KM}}const outer=planets[planets.length-1];const time=computeTimeScale(outer.orbitPeriodSec,120,300);const systemRadiusM=starRadiusM*30;return{name:systemName,code:systemCode,star:{class:starClass,massKg:starMassKg,radiusKm:starRadiusKm,radiusM:starRadiusM},systemRadiusM,planets,time}}function isMobileLike(){try{if(navigator.userAgentData&&typeof navigator.userAgentData.mobile==='boolean'){if(navigator.userAgentData.mobile)return true}}catch{}const ua=(typeof navigator!=='undefined'&&navigator.userAgent)?navigator.userAgent:'';const coarse=typeof matchMedia==='function'&&matchMedia('(pointer: coarse)').matches;return coarse||/Mobi|Android|iPhone|iPad|iPod|Phone|Tablet|Mobile/i.test(ua)}function getTargetCssSize(){const mobile=isMobileLike();if(mobile&&typeof screen!=='undefined'){return{width:Math.max(1,screen.width),height:Math.max(1,screen.height)}}return{width:Math.max(1,window.innerWidth),height:Math.max(1,window.innerHeight)}}function setupCanvases({bgId='bgCanvas',mainId='mainCanvas',onResize=null}={}){const bg=document.getElementById(bgId);const main=document.getElementById(mainId);if(!bg||!main)throw new Error('Canvas elements not found');const state={dpr:Math.max(1,Math.floor(window.devicePixelRatio||1)),cssWidth:0,cssHeight:0,bg,main,bgCtx:null,mainCtx:null,};function applySize(){const{width,height}=getTargetCssSize();state.cssWidth=width;state.cssHeight=height;state.dpr=Math.max(1,window.devicePixelRatio||1);[bg,main].forEach((c)=>{c.style.width=width+'px';c.style.height=height+'px';c.width=Math.floor(width*state.dpr);c.height=Math.floor(height*state.dpr)});state.bgCtx=bg.getContext('2d');state.mainCtx=main.getContext('2d');[state.bgCtx,state.mainCtx].forEach((ctx)=>{ctx.setTransform(1,0,0,1,0,0);ctx.scale(state.dpr,state.dpr);ctx.imageSmoothingEnabled=true});if(typeof onResize==='function'){onResize({width,height,dpr:state.dpr,bgCtx:state.bgCtx,mainCtx:state.mainCtx})}}applySize();let resizeTimer=null;const handle=()=>{clearTimeout(resizeTimer);resizeTimer=setTimeout(applySize,100)};window.addEventListener('resize',handle,{passive:true});window.addEventListener('orientationchange',handle,{passive:true});return{get bgCtx(){return state.bgCtx},get mainCtx(){return state.mainCtx},get dpr(){return state.dpr},get size(){return{width:state.cssWidth,height:state.cssHeight}},resizeNow:applySize,destroy(){window.removeEventListener('resize',handle);window.removeEventListener('orientationchange',handle)}}}function generateStarfield(rng,width,height){const count=randInt(rng,200,500);const stars=new Array(count);for(let i=0;i<count;i++){stars[i]={x:randFloat(rng,0,width),y:randFloat(rng,0,height),size:randInt(rng,1,2),alpha:randFloat(rng,0.6,0.8),}}return stars}function drawStarfield(ctx,stars){if(!ctx||!stars)return;ctx.save();ctx.setTransform(1,0,0,1,0,0);ctx.restore();ctx.fillStyle='#000000';const{canvas}=ctx;const cssW=parseInt(canvas.style.width||canvas.width,10)||canvas.width;const cssH=parseInt(canvas.style.height||canvas.height,10)||canvas.height;ctx.fillRect(0,0,cssW,cssH);for(const s of stars){ctx.fillStyle=`rgba(255,255,255,${s.alpha.toFixed(3)})`;const half=s.size/2;ctx.fillRect(s.x-half,s.y-half,s.size,s.size)}}function createCamera(viewWidth,viewHeight,worldRadiusM){const state={cx:0,cy:0,scale:1,viewWidth,viewHeight};function fit(radiusM){const minEdge=Math.max(1,Math.min(state.viewWidth,state.viewHeight));state.scale=(minEdge*0.9)/(2*Math.max(1,radiusM))}function setViewport(w,h){state.viewWidth=Math.max(1,w);state.viewHeight=Math.max(1,h)}function computeFitScale(radiusM){const minEdge=Math.max(1,Math.min(state.viewWidth,state.viewHeight));return(minEdge*0.9)/(2*Math.max(1,radiusM))}fit(worldRadiusM);return{get center(){return{x:state.cx,y:state.cy}},set centerXY(v){state.cx=v.x;state.cy=v.y},get scale(){return state.scale},set scale(val){state.scale=clamp(val,1e-12,1e12)},setViewport,fit,computeFitScale,worldToScreen(wx,wy){const x=(wx-state.cx)*state.scale+state.viewWidth/2;const y=(state.cy-wy)*state.scale+state.viewHeight/2;return{x,y}},radiusToPixels(rMeters){return rMeters*state.scale}}}function drawWavyRing(ctx,cx,cy,radius,waveCount,amplitude,rotationRad,color){if(radius<=0)return;ctx.strokeStyle=color;ctx.lineWidth=1;ctx.beginPath();const steps=Math.max(32,Math.floor(waveCount*8));for(let i=0;i<=steps;i++){const t=(i/steps)*TAU;const angle=t+rotationRad;const wave=Math.sin(waveCount*t)*amplitude;const r=radius+wave;const px=cx+r*Math.cos(angle);const py=cy+r*Math.sin(angle);if(i===0)ctx.moveTo(px,py);else ctx.lineTo(px,py)}ctx.closePath();ctx.stroke()}function drawSun(ctx,cam,star,rotationInner,rotationOuter){const{x,y}=cam.worldToScreen(0,0);const rPx=cam.radiusToPixels(star.radiusM);ctx.fillStyle='#FFD700';ctx.beginPath();ctx.arc(x,y,rPx,0,TAU);ctx.fill();drawWavyRing(ctx,x,y,rPx*1.1,8,rPx*0.05,rotationInner,'#FFA500');drawWavyRing(ctx,x,y,rPx*1.2,6,rPx*0.05,rotationOuter,'#FF8C00')}function drawOrbit(ctx,cam,orbitRadiusM){const{x,y}=cam.worldToScreen(0,0);const rPx=cam.radiusToPixels(orbitRadiusM);if(rPx<0.5)return;ctx.strokeStyle='rgba(64,224,208,0.6)';ctx.lineWidth=1;ctx.setLineDash([5,10]);ctx.beginPath();ctx.arc(x,y,rPx,0,TAU);ctx.stroke();ctx.setLineDash([])}function drawHillSphere(ctx,cam,planetWorldX,planetWorldY,hillRadiusM){const{x,y}=cam.worldToScreen(planetWorldX,planetWorldY);const rPx=cam.radiusToPixels(hillRadiusM);if(rPx<0.5)return;ctx.fillStyle='rgba(255,100,100,0.15)';ctx.beginPath();ctx.arc(x,y,rPx,0,TAU);ctx.fill()}function drawPlanet(ctx,cam,planetWorldX,planetWorldY,planetRadiusM,planetColor){const{x,y}=cam.worldToScreen(planetWorldX,planetWorldY);const rPx=cam.radiusToPixels(planetRadiusM);if(rPx<0.5)return;ctx.fillStyle=planetColor||'#FFFFFF';ctx.beginPath();ctx.arc(x,y,rPx,0,TAU);ctx.fill()}function createHUD(containerEl,system){const lines=[];const headerLines=[];let animIndex=0;let charIndex=0;let animDone=false;let flickerPhase=true;let flickerTime=0;const FLICKER_DURATION=2000;function formatNum(x){if(typeof x!=='number')return String(x);return Math.floor(x).toLocaleString('en-US',{useGrouping:false})}headerLines.push(`STAR:<${system.name}${system.code}>`);headerLines.push(`CLASS:<${system.star.class}>`);headerLines.push(`RADIUS:<${formatNum(system.star.radiusKm)}>`);headerLines.push(`MASS:<${formatNum(system.star.massKg)}>`);headerLines.push(`BODIES:<0/${system.planets.length}>`);lines.push(...headerLines);for(const p of system.planets){lines.push('');lines.push(`BODY:${p.name}`);lines.push(`TYPE:${p.geo}`);lines.push(`ATMO:${p.atmo}`);lines.push(`FAUNA:${p.fauna}`);lines.push(`FLORA:${p.flora}`)}const startTime=Date.now();function tick(){if(animDone)return;const elapsed=Date.now()-startTime;if(elapsed<FLICKER_DURATION){flickerTime=elapsed;renderFlicker();return}if(flickerPhase){flickerPhase=false;animIndex=headerLines.length}if(animIndex>=lines.length){animDone=true;return}const line=lines[animIndex];if(charIndex<line.length){charIndex+=1}else{animIndex+=1;charIndex=0}render()}function renderFlicker(){const progress=flickerTime/FLICKER_DURATION;const flickerChance=0.3*(1-progress);const displayed=[];for(const line of headerLines){if(Math.random()>flickerChance){displayed.push(line)}else{const garbled=line.split('').map(c=>Math.random()>0.5?c:(Math.random()>0.5?String.fromCharCode(33+Math.floor(Math.random()*94)):' ')).join('');displayed.push(garbled)}}containerEl.textContent=displayed.join('\n')}function render(){const displayed=[];for(let i=0;i<animIndex;i++){displayed.push(lines[i])}if(animIndex<lines.length){const partial=lines[animIndex].slice(0,charIndex);displayed.push(partial)}containerEl.textContent=displayed.join('\n');containerEl.scrollTop=containerEl.scrollHeight}return{tick,get done(){return animDone}}}function setupCameraControls(canvas,camera,options={}){const LERP=options.lerpFactor||0.1;const ZOOM_SPEED=options.zoomSpeed||0.001;const target={scale:camera.scale,cx:camera.center.x,cy:camera.center.y};let dragging=false;let lastX=0,lastY=0;function onWheel(e){e.preventDefault();const delta=e.deltaY;const factor=Math.exp(-delta*ZOOM_SPEED);target.scale*=factor}function onMouseDown(e){if(e.button===0){dragging=true;lastX=e.clientX;lastY=e.clientY;canvas.style.cursor='grabbing'}}function onMouseMove(e){if(!dragging)return;const dx=e.clientX-lastX;const dy=e.clientY-lastY;lastX=e.clientX;lastY=e.clientY;const worldDx=-dx/camera.scale;const worldDy=dy/camera.scale;target.cx+=worldDx;target.cy+=worldDy}function onMouseUp(e){if(e.button===0){dragging=false;canvas.style.cursor='grab'}}function update(){camera.scale+=(target.scale-camera.scale)*LERP;const curr=camera.center;camera.centerXY={x:curr.x+(target.cx-curr.x)*LERP,y:curr.y+(target.cy-curr.y)*LERP}}function resetView(systemRadiusM){target.cx=0;target.cy=0;target.scale=camera.computeFitScale(systemRadiusM)}canvas.addEventListener('wheel',onWheel,{passive:false});canvas.addEventListener('mousedown',onMouseDown);canvas.addEventListener('mousemove',onMouseMove);canvas.addEventListener('mouseup',onMouseUp);canvas.addEventListener('mouseleave',onMouseUp);canvas.style.cursor='grab';return{update,resetView,destroy(){canvas.removeEventListener('wheel',onWheel);canvas.removeEventListener('mousedown',onMouseDown);canvas.removeEventListener('mousemove',onMouseMove);canvas.removeEventListener('mouseup',onMouseUp);canvas.removeEventListener('mouseleave',onMouseUp)}}}function getSeedFromURL(){const url=new URL(window.location.href);const s=url.searchParams.get('seed');if(s&&/^\d{8}$/.test(s))return s;return null}function main(){const seed=getSeedFromURL()||getTodaySeed();const rng=createRNG(seed);const system=generateSolarSystem(rng);let stars=[];let camera=null;const outerPlanet=system.planets[system.planets.length-1];const fitRadius=outerPlanet.orbitRadiusM+outerPlanet.hillRadiusM*2;const canvases=setupCanvases({onResize:({width,height,bgCtx})=>{stars=generateStarfield(rng,width,height);drawStarfield(bgCtx,stars);if(camera)camera.setViewport(width,height);else camera=createCamera(width,height,fitRadius)}});const hudEl=document.getElementById('hud');const hud=hudEl?createHUD(hudEl,system):null;const mainCanvas=document.getElementById('mainCanvas');const controls=setupCameraControls(mainCanvas,camera,{lerpFactor:0.1});const resetBtn=document.getElementById('resetViewBtn');if(resetBtn){resetBtn.addEventListener('click',()=>{controls.resetView(fitRadius)})}let rotInner=0;let rotOuter=0;const toRad=Math.PI/180;const dt=1/30;const timeScale=system.time.timeScale;let gameTime=0;const ctx=canvases.mainCtx;let frameCount=0;function frame(){frameCount++;if(hud&&frameCount%2===0)hud.tick();rotInner+=3*toRad;rotOuter-=1.7*toRad;gameTime+=dt*timeScale;controls.update();ctx.clearRect(0,0,canvases.size.width,canvases.size.height);for(const p of system.planets){drawOrbit(ctx,camera,p.orbitRadiusM)}for(const p of system.planets){const angle=p.phaseRad+(p.orbitSpeedMps/p.orbitRadiusM)*gameTime;const wx=p.orbitRadiusM*Math.cos(angle);const wy=p.orbitRadiusM*Math.sin(angle);drawHillSphere(ctx,camera,wx,wy,p.hillRadiusM)}drawSun(ctx,camera,system.star,rotInner,rotOuter);for(const p of system.planets){const angle=p.phaseRad+(p.orbitSpeedMps/p.orbitRadiusM)*gameTime;const wx=p.orbitRadiusM*Math.cos(angle);const wy=p.orbitRadiusM*Math.sin(angle);drawPlanet(ctx,camera,wx,wy,p.radiusM,p.color)}requestAnimationFrame(frame)}requestAnimationFrame(frame);window.__SOLAR__={seed,rng,canvases,system,camera,hud,controls}}if(document.readyState==='loading'){window.addEventListener('DOMContentLoaded',main,{once:true})}else{main()}})();</script>